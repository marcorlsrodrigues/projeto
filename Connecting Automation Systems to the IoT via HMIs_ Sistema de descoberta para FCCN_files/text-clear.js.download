(function(a){a.textClear=function(b,c){this.textbox=a(b);this.options=a.extend({},a.textClear.defaults,c||{});this.container=null;this.button=null;this.buttonClickEvent=null;if(!c||c.rtl===undefined){this.options.rtl=(a("html").attr("dir")||"").toLowerCase()==="rtl";}if(!this.container){this.container=a("<span>").attr({id:this.textbox.attr("id")+"_container"}).addClass("text-container").css({position:"relative",display:"inline-block"});}if(!this.button){this.button=a(this.options.btnElement).attr({id:this.textbox.attr("id")+this.options.btnIdSuffix,title:this.options.btnToolTip,tabindex:this.options.btnTabIndex,"aria-hidden":true,"class":this.options.btnCssClass,"data-auto":"text_clear_button"}).text(this.options.btnText);}this.buttonClickEvent=function(e){var d=a(e.target);if(this.options.useClearButtonEvent&&this.options.clearButtonSelector&&a(this.options.clearButtonSelector).length){a(this.options.clearButtonSelector).first().trigger("click");}else{if(a.isFunction(this.options.onClear)){c.onClear.apply(this,[d]);}else{this.textbox.val(this.options.defaultTextValue);}}if(this.options.focusAfterClear){this.textbox.focus();}this.button.toggleClass("visible",this.textbox.val().length>0);e.preventDefault();e.stopPropagation();};this.textChangeEvent=function(d){this.setPosition();this.button.toggleClass("visible",this.textbox.val().length>0);};this.setup();};a.textClear.defaults={btnElement:"<a>",btnTabIndex:-1,btnToolTip:"Clear",btnCssClass:"clear-button",btnText:"",btnIdSuffix:"-clear",alterTextPadding:false,onClear:a.noop(),focusAfterClear:true,absolutePosition:true,clearButtonSelector:".evt-clear",useClearButtonEvent:true,spacingConstant:4,ltrTextBoxClassName:"ltr-text",rtlTextBoxClassName:"rtl-text"};a.extend(a.textClear.prototype,{setup:function(){if(this.options.absolutePosition){this.textbox.wrap(this.container);}this.button.insertAfter(this.textbox).on("click.textClear",a.proxy(this.buttonClickEvent,this));this.setPosition();if(this.options.clearButtonSelector&&a(this.options.clearButtonSelector).length&&!a(this.options.clearButtonSelector).hasClass("hidden")){a(this.options.clearButtonSelector).addClass("hidden");}this.textbox.on("keyup.textClear paste.textClear change.textClear",a.proxy(this.textChangeEvent,this));this.textChangeEvent();},setPosition:function(){var i=this.textbox.get(0),e=this.textbox.is("textarea"),k={left:parseInt(this.textbox.css("padding-left"),10),right:parseInt(this.textbox.css("padding-right"),10)};var d=(this.textbox.attr("dir")||a("html").attr("dir")||"").toLowerCase()==="rtl",b=(this.options.rtl)?"right":"left",c=(this.options.rtl)?"left":"right";var m=(d)?this.options.rtlTextBoxClassName:this.options.ltrTextBoxClassName;this.textbox.removeClass(this.options.rtlTextBoxClassName+" "+this.options.ltrTextBoxClassName).addClass(m);if(this.options.alterTextPadding&&k[c]<this.button.outerWidth()){if(d===this.options.rtl){this.textbox.css("padding-"+c,this.button.outerWidth()+k[b]+this.options.spacingConstant);}else{this.textbox.css("padding-"+b,this.button.outerWidth()+k[c]+this.options.spacingConstant);}}if(this.options.absolutePosition){var f=i.parentElement,g=f.getBoundingClientRect(),j=i.getBoundingClientRect(),l=this.textbox.position();l[b]=(j[b]-g[b]);if(this.options.rtl){l[b]*=-1;}l[c]=l[b]+this.textbox.outerWidth();l.top=j.top-g.top;var h={};h.position="absolute";h[c]="auto";h.top=l.top+((e)?4:Math.round(this.textbox.outerHeight()/2-this.button.outerHeight()/2));h[b]=(d!==this.options.rtl)?(l[b]+this.options.spacingConstant):(l[c]-this.button.outerWidth()-this.options.spacingConstant);this.button.css(h);}},reload:function(b){this.textbox=a(b);this.button.off("click.textClear").on("click.textClear",a.proxy(this.buttonClickEvent,this));this.setPosition();this.textbox.on("keyup.textClear paste.textClear change.textClear",a.proxy(this.textChangeEvent,this));this.textChangeEvent();},destroy:function(){this.button.off("click.textClear");this.textbox.off("keyup.textClear paste.textClear change.textClear");this.textbox.removeAttr("style");if(this.options.absolutePosition){this.textbox.unwrap();this.button.remove();this.container.remove();}this.container=null;this.button=null;this.buttonClickEvent=null;a(this).removeData("textclearinstance");}});a.fn.textClear=function(d){if(typeof d==="string"){var c=a(this).data("textclearinstance"),b=Array.prototype.slice.call(arguments,1);return c[d].apply(c,b);}else{return this.each(function(){var e=a(this).data("textclearinstance");if(e){if(d){a.extend(e.options,d);}e.reload(this);}else{var f=a.extend({},d,a(this).data("textclear")||{});a(this).data("textclearinstance",new a.textClear(this,f));}});}};a(function(){a("[data-textclear]").textClear();});}(jQuery));