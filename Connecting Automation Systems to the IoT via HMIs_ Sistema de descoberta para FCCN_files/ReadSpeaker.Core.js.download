ReadSpeaker.Common=function(){var c={revision:"3975"},e={onAdapterReady:[],onInit:[],onCoreLoaded:[],onModsLoaded:[],onAfterModsLoaded:[],onAfterExtraModsLoaded:[],onConfigLoaded:[],onConfigSetup:[],onDOMReady:[],onReady:[],onSelectedText:[],onDeselectedText:[],onSettingsInitialized:[],onSettingsChanged:[],onSettingsLoaded:[],onSettingsClosed:[],onDownloadLoaded:[],onFocusIn:[],onFocusOut:[],onUIInitialized:[],onUIBeforePlay:[],onUIAfterPlay:[],onUIPause:[],onUISliderMove:[],onUIStop:[],onUIShowPlayer:[],onUIClosePlayer:[],onAPIPlay:[],onAPIPause:[],onAPIStop:[],onAPIVolumeUp:[],onAPIVolumeDown:[],onAPIMute:[],onAPIFastForward:[],onAPIRewind:[],onAPISetVolume:[],onAPISetProgress:[],onAPIGetProgress:[],onAPIInitAdapter:[],onAPIReleaseAdapter:[],onAPIReloadAdapter:[],onBeforeSyncInit:[],onAfterSyncInit:[],onBeforeSync:[],onAfterSync:[],onAfterSyncExit:[],onBeforeContentChange:[],onAfterContentChange:[],onBeforeGetAudioLink:[],onBeforeParamsSet:[],onAfterParamsSet:[],onAudioLoadError:[],onVolumeAdjusted:[],onChunkResume:[]},g={speed:function(f,h){var k=parseInt(h||rspkr.pub.Config.item("general.defaultSpeedValue")||100),m=parseInt(rspkr.pub.Config.item("general.defaultSlowSpeedValue")||k-25),n=parseInt(rspkr.pub.Config.item("general.defaultFastSpeedValue")||k+25);switch(f){case"slow":return m;case"medium":return k;case"fast":return n;default:return k;}}},a={audioLink:null,params:{},postContent:"",postLink:null,saveLink:null,selectedHTML:"",selectedText:"",selectedRange:null,sync:"wordsent",syncLink:null,browser:{name:"",flashVersion:"",version:"",OS:"",html5AudioFormat:"",html5Support:!1,html5Priority:!1,syncContainer:""},setParams:function(f){rspkr.log("[rspkr.c.data.setParams] "+f);if("string"==typeof f){this.params={};var h="",k="",h="",k=f.split("?");rspkr.cfg.item("general.servercall",k[0]);f=k[1].split(/[;&]/);for(var m=0;m<f.length;m++){if((h=f[m].split("="))&&2==h.length){var k=decodeURIComponent(h[0]),n=h[1],h=decodeURIComponent(h[1]);if("url"==k&&!h.length){n=encodeURIComponent(document.location.href);}else{if("lang"==k&&2==h.length){for(var o in rspkr.cfg.item("phrases")){if(rspkr.cfg.item("phrases").hasOwnProperty(o)&&h==o.substring(0,2)){n=o;break;}}}else{if("readid"==k||"readclass"==k){for(var h=n.split(","),n=[],q=function(r,t){for(var s=0,u=r.length;s<u;s++){if(this[s]===t){return s;}}return -1;},p=0;p<h.length;p++){-1==q(n,h[p])&&n.push(h[p]);}n=n.join(",");}}}this.params[k]=n;}}this.params.rsjs_ver=rspkr.getVersion();this.params.synccontainer=this.browser.syncContainer;this.params.url||(this.params.url=document.location.href);this.params.readid=this.params.readid||"";if(rspkr.c.data.selectedText||rspkr.c.data.selectedHTML){delete this.params.readid,delete this.params.readclass;}rspkr.Common.dispatchEvent("onAfterParamsSet");}},setDefaultValues:function(){rspkr.log("[rspkr.c.data.setDefaultValues] Called!");rspkr.Common.data.selectedHTML="";rspkr.Common.data.saveLink=null;},setPostContent:function(f){if("string"==typeof f){if("textsel"===f){f=this.selectedHTML;}else{var h=[];f="";rspkr.hl&&rspkr.hl.Restore.hasMarkup()&&rspkr.hl.sync.fullCleanUp();var k=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&(k=k.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(",")));rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&(k=k.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost")){for(var m=0;m<k.length;m++){var n=$rs.get(k[m]);$rs.isArray(n)&&0<n.length?h.concat(n):$rs.isArray(n)||h.push(n);}}else{h=$rs.get(k.join(","));}$rs.isArray(h)||(h=[h]);for(m=0;k=h[m];m++){var n=k.id?' id="'+k.id+'"':"",o=k.className?' class="'+k.className+'"':"",p;p=k.nodeName&&"TABLE"==k.nodeName?"TABLE":"DIV";f+="<"+p+n+o+">"+k.innerHTML+"</"+p+">";}h=document.createElement("div");h.innerHTML=f;f=$rs.findIn(h,".rs_skip.rs_preserve");$rs.isArray(f)||(f=[f]);for(m=0;k=f[m];m++){k.innerHTML="";}f=h.innerHTML;}!0===rspkr.cfg.item("general.parseMathJax")&&(f=this.parseMathJax(f));this.postContent=l.encode(f);}},parseMathJax:function(f){var h=document.createElement("div"),k,m,n;m=window.MathJax;h.innerHTML=f;if(k=$rs.findIn(h,".MathJax")){f=$rs.findIn(k,".math");$rs.isArray(f)&&0===f.length&&(f=k);f=$rs.isArray(f)?f:[f];for(var o=f.length-1;0<=o;o--){"object"===typeof f[o]&&(n=document.createElement("div"),mjaxObj=m.Hub.getJaxFor(f[o].id),n.innerHTML=mjaxObj.originalText,k=$rs.closest(f[o],"div.MathJax_Display"),$rs.hasClass(f[o],"math")?(f[o].parentNode.parentNode.replaceChild(n,f[o].parentNode),k&&k.tagName&&k.parentNode.replaceChild(n,k)):k?k.parentNode.replaceChild(n,k):f[o].parentNode.replaceChild(n,f[o]));}m=h.getElementsByTagName("script");for(f=m.length-1;0<=f;f--){m[f].type&&"math/mml"===m[f].type&&m[f].parentNode.removeChild(m[f]);}return h.innerHTML;}return f;},setSelectedText:function(f){this.selectedText="";var h=void 0,k=void 0;if(window.getSelection){k=window.getSelection();if(!k.isCollapsed){if(k.getRangeAt){var m=k.getRangeAt(0),n=k.getRangeAt(k.rangeCount-1),h=document.createRange();h.setStart(m.startContainer,m.startOffset);h.setEnd(n.endContainer,n.endOffset);}else{h=document.createRange(),h.setStart(k.anchorNode,k.anchorOffset),h.setEnd(k.focusNode,k.focusOffset);}h?(DOM=h.cloneContents(),object=document.createElement("div"),object.appendChild(DOM.cloneNode(!0)),this.selectedText=object.innerHTML):this.selectedText=k;}this.selectedRange=h;}else{document.selection?(k=document.selection,this.selectedText=(h=k.createRange())&&h.htmlText&&h.text&&0<h.text.length?h.htmlText:h&&h.text?h.text:"",this.selectedRange=h.duplicate()):document.getSelection&&(this.selectedText=document.getSelection());}window.getSelection?0<this.selectedText.length&&window.getSelection().getRangeAt&&window.getSelection().getRangeAt(0)&&0<window.getSelection().getRangeAt(0).toString().length&&f?d("onSelectedText",window,[f]):(this.selectedText="",d("onDeselectedText",window,["empty"])):0<this.selectedText.length&&f?d("onSelectedText",window,[f]):d("onDeselectedText",window,["empty"]);rspkr.log("[rspkr.c.setSelectedText] Selected text length is "+this.selectedText.length);},createReadRange:function(f){if(f=document.getElementById(f)){if(document.selection&&(9>this.browser.version||9>document.documentMode)){var h=document.body.createTextRange();h.moveToElementText(f);this.selectedRange=h;this.selectedText=h.htmlText;}else{h=document.createRange(),h.selectNodeContents(f),this.selectedRange=h,this.selectedText=h.toString();}}},getParam:function(f){return this.params&&this.params[f]&&void 0!==this.params[f]?this.params[f]:null;},getParams:function(){return this.params;},getPostContent:function(){return this.postContent;},getRestoreContent:function(){return this.restoreContent;},getSelectedText:function(){return this.selectedText;},getAudioLink:function(f,h){rspkr.devt("onBeforeGetAudioLink",window);h="undefined"!==typeof h?h:rspkr.HL;this.audioLink=null;var k={},m;for(m in this.params){this.params.hasOwnProperty(m)&&(k[m]=this.params[m]);}for(m in f){f.hasOwnProperty(m)&&(k[m]=f[m]);}k.speed=g.speed(rspkr.Common.Settings.get("hlspeed"),k.speed?k.speed:void 0);(m=rspkr.cfg.item("general.selectionEngine"))&&"newcontent"===m&&k.hasOwnProperty("readid")&&1>this.selectedText.length&&(!document.selection||document.selection&&8<rspkr.Common.data.browser.version&&8<document.documentMode)&&this.createReadRange(k.readid);if(k.readid&&/rslightbox_content/gi.test(k.readid)){0==rs.cfg.item("general.usePost")?(rs.cfg.item("general.usePost",!0),rspkr.c.addEvent("onSettingsClosed",function(){rs.cfg.item("general.usePost",!1);rs.PlayerAPI.stop();})):rspkr.c.addEvent("onSettingsClosed",function(){rs.PlayerAPI.stop();});var n=function(o){for(var q=function(t,u){return document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null)[u]:t.currentStyle?t.currentStyle[u]:t.style[u];},p=0;p<o.childNodes.length;p++){var r=o.childNodes[p],s=r.className&&-1!==r.className.indexOf("rs_skip_always");1!==r.nodeType||"none"!=q(r,"display")&&"hidden"!=q(r,"visibility")||s?r.title?$rs.addClass(r,"rs_skip_always"):1===r.nodeType&&n(r):$rs.addClass(r,"rs_skip_always");}};n($rs.get("rslightbox_content"));}0<this.selectedText.length||0<this.selectedHTML.length?(0<this.selectedText.length&&h.clientMarkup.preProcess.init(),k.sync="user",k.syncalignuser=rspkr.st.get("hl"),this.setPostContent("textsel"),this.audioLink=b.issuePost(k)):!0===rspkr.cfg.item("general.premarkup")?(k.sync="user",this.setPostContent("nosel"),this.audioLink=!0===rspkr.pub.Config.item("general.usePost")?b.issuePost(k):i(k)):!0===rspkr.pub.Config.item("general.usePost")?(k.sync="wordsent",this.setPostContent("nosel"),this.audioLink=b.issuePost(k)):(k.sync="wordsent",this.audioLink=i(k));rspkr.log("[rspkr.c.data.getAudioLink] Audio link: "+this.audioLink);return this.audioLink;},setSettingsChanged:function(f){"hlspeed"===f&&(rspkr.c.data.settingsChanged=!0);},settingsChanged:!1,getSaveData:function(f,h){rspkr.log("[rspkr.c.data.getSaveData]");f=f||"link";h=h||!1;var k=this.saveLink;if(!this.saveLink||this.settingsChanged||h){h&&rspkr.c.data.setParams(h);rspkr.c.data.params.customerid||(k=$rs.get("."+rspkr.cfg.item("ui.rsbtnClass")),(k=$rs.isArray(k)&&0<k.length?k[0]:k)&&rspkr.c.data.setParams($rs.getAttr($rs.findIn(k,".rsbtn_play"),"href")));var k={},m={audioformat:"mp3"};this.settingsChanged=!1;"iOS"!==this.browser.OS&&"dialog"===f&&(m.save="1");for(var n in this.params){this.params.hasOwnProperty(n)&&(k[n]=this.params[n]);}for(n in m){m.hasOwnProperty(n)&&(k[n]=m[n]);}k.speed=g.speed(rspkr.st.get("hlspeed"),k.speed);0<this.selectedHTML.length?(this.setPostContent("textsel"),k=b.issuePost(k)):!0===rspkr.cfg.item("general.usePost")?(this.setPostContent("nosel"),k=b.issuePost(k)):k=i(k);h||(this.saveLink=k);}return k;}},i=function(f){var h="";"undefined"!=typeof rspkr.cfg.item("general.servercall")?h=rspkr.cfg.item("general.servercall")+"?":(h=$rs.get("."+rspkr.cfg.item("ui.rsbtnClass")),h=$rs.isArray(h)?h[0]:h,h=$rs.getAttr($rs.findIn(h,".rsbtn_play"),"href").split("?")[0]+"?");for(var k in f){f.hasOwnProperty(k)&&f[k]&&(h+=k+"="+f[k]+"&");}h=h.substr(0,h.length-1);return rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(h):h;},j=function(){var k=rspkr.cfg.item("extraMods")||[],m=[c.major,c.minor,c.update,c.revision].join("."),n=0,o="Explorer"==rs.c.data.browser.name&&8>=rs.c.data.browser.version;rspkr.log("[rspkr.c.loadExtraMods] Number of mod files to load: "+k.length);for(var p=0;p<k.length;p++){var r=k[p][0],q=r.substring(r.lastIndexOf(".")),t=void 0;".js"===q?(t=document.createElement("script"),t.type="text/javascript",t.src=rs.params.path+"mods/"+r+"?v="+m,t.async=!0):".css"===q&&(r=rs.params.path+"mods/"+r+"?v="+m,o?t=document.createStyleSheet(r):(t=document.createElement("link"),t.type="text/css",t.rel="stylesheet",$rs.setAttr(t,"href",r)));if(o||void 0===t.onreadystatechange){r=t,(s=k[p][1])&&"function"==typeof s&&s.apply(window),n++,n==k.length&&rs.devt("onAfterExtraModsLoaded",window),r.onload=void 0;}else{var r=t,s=k[p][1];if("complete"==t.readyState||"loaded"==t.readyState){s&&"function"==typeof s&&s.apply(window),n++,n==k.length&&rs.devt("onAfterExtraModsLoaded",window);}r.onreadystatechange=void 0;}o&&".css"===q||document.getElementsByTagName("head")[0].appendChild(t);}},d=function(f,k,m){if(e[f]){m=m||[];rspkr.displog[f]=rspkr.displog[f]?++rspkr.displog[f]:1;if(!e[f].length){return rspkr.log("[rspkr.c] Dispatched event: "+f+" - no handlers to call.",2),!0;}rspkr.log("[rspkr.c] Dispatching event: "+f,1);for(var n in e[f]){if(e[f].hasOwnProperty(n)&&"function"==typeof e[f][n]){try{"__self__"===k&&(k=e[f][n]),e[f][n].apply(k,m);}catch(o){rspkr.log("[rspkr.c._dispatchEvent] Error: "+o.message,3),this.isok=!1;}}else{if("object"==typeof e[f][n]){try{var p=e[f][n];p.func.apply(p.context||window,p.params||m);}catch(q){this.isok=!1;}}}}}else{rspkr.log("[rspkr.c] Undefined event: "+f,3);}},b={issuePost:function(f){rspkr.log("[rspkr.c] Using POST");document.getElementById("ReadSpeakerPostIframe")||this.createIframe();var h=Math.random(),k=this.createForm(f),m;"undefined"!==typeof rspkr.cfg.item("general.servercall")?f=rspkr.cfg.item("general.servercall")+"?":(f=$rs.get("."+rspkr.cfg.item("ui.rsbtnClass")),f=$rs.isArray(f)?f[0]:f,f=$rs.getAttr($rs.findIn(f,".rsbtn_play"),"href").split("?")[0]+"?");m=("string"===typeof f&&f.length?f.split("/").pop():rspkr.pub.Config.item("general.rsent")).replace("?","");f=f&&f.match(/[^\/]*\/\/[^\/]*/);var n=rspkr.cfg.item("general.iframeproxy")?rspkr.cfg.item("general.iframeproxy"):"/enterprise/iframeproxy.php";f=f?f.pop()+n+"?rsent="+m+"&version="+rspkr.pub.Config.item("general.proxyVersion"):rspkr.pub.Config.item("general.protocol")+"//"+rspkr.pub.Config.item("general.subdomain")+"."+rspkr.pub.Config.item("general.domain")+n+"?rsent="+rspkr.pub.Config.item("general.rsent")+"&version="+rspkr.pub.Config.item("general.proxyVersion");f+="&randid="+h;rspkr.c.data.params.customerid&&(f+="&customerid="+rspkr.c.data.params.customerid);f=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(f):f;k.action=f;m=document.createElement("textarea");1<a.getSelectedText().length?m.setAttribute("name","selectedhtml_base64"):m.setAttribute("name","html_base64");m.innerHTML=a.getPostContent();k.appendChild(m);setTimeout(function(){document.body.appendChild(k);k.submit();document.body.removeChild(k);},0);return f+"&listen=1&randid="+h;},createForm:function(f){var h,k=document.createElement("form");k.target="ReadSpeakerPostIframe";k.method="post";for(var m in f){h=document.createElement("input"),h.setAttribute("name",m),"url"===m?h.setAttribute("value",decodeURIComponent(f[m])):h.setAttribute("value",f[m]),k.appendChild(h);}h=document.createElement("input");h.setAttribute("name","output");h.setAttribute("value","audiolink");k.appendChild(h);return k;},createIframe:function(){var f=null;if(document.selection){try{f=document.createElement('<iframe name="ReadSpeakerPostIframe">');}catch(h){f=document.createElement("iframe");}}else{f=document.createElement("iframe");}f.setAttribute("name","ReadSpeakerPostIframe");f.setAttribute("id","ReadSpeakerPostIframe");f.setAttribute("style","display: none; position: absolute;");f.style.display="none";var k=document.getElementsByTagName("body"),m=null;0<k.length&&(m=k.item(0));m&&m.appendChild(f);},removeIframe:function(){document.getElementById("ReadSpeakerPostIframe");}},l={encode:function(f){newdata=encodeURIComponent(f);var h=0,k=0;for(f=[];h<newdata.length;h++){37!=newdata.charCodeAt(h)?f[k]=newdata.charCodeAt(h):(f[k]=parseInt("0x"+newdata.charAt(h+1)+""+newdata.charAt(h+2)),h+=2),k++;}h=f.length;parseInt((h+2)/3);for(var k=new String,m=parseInt(h/3),n,o=h-3*m,h=0;h<3*m;h+=3){n=this.chars(f[h]>>2),k+=n,n=this.chars((f[h]&3)<<4|f[h+1]>>4),k+=n,n=this.chars((f[h+1]&15)<<2|f[h+2]>>6),k+=n,n=this.chars(f[h+2]&63),k+=n;}1==o&&(k+=this.chars(f[h]>>2),k+=this.chars((f[h]&3)<<4),k+="==");2==o&&(k+=this.chars(f[h]>>2),k+=this.chars((f[h]&3)<<4|f[h+1]>>4),k+=this.chars((f[h+1]&15)<<2),k+="=");return k;},decode:function(k){for(var m="",n="",o=0,p=0,r="",s=k.length;o<s;){if(-1!=this.value(k[o])){for(var r=k.substring(o,o+4),t=p=0;4>t;t++){"="==r[t]&&p++;}for(t=0;t<3-p;t++){0==t?n=this.value(r[0])<<2|(this.value(r[1])&48)>>4:1==t?n=(this.value(r[1])&15)<<4|(this.value(r[2])&60)>>2:2==t&&(n=(this.value(r[2])&3)<<6|this.value(r[3]));var q=n.toString(16);1==q.length&&(q="0"+q);m+="%"+q;}o+=4;}else{o++;}}return decodeURIComponent(m);},value:function(f){f=f.charCodeAt(0);return 65<=f&&90>=f?f-65:97<=f&&122>=f?f-97+26:48<=f&&57>=f?f-48+52:43==f?62:47==f?63:-1;},chars:function(f){return 26>f?String.fromCharCode(f+65):52>f?String.fromCharCode(f+97-26):62>f?String.fromCharCode(f+48-52):62==f?"+":63==f?"/":String.fromCharCode(0);}};return{meta:c,init:function(){d("onInit",window);e.onInit=[];e.onUIShowPlayer.push(rspkr.Common.data.setDefaultValues);e.onSettingsChanged.push(rspkr.Common.data.setSettingsChanged);e.onAfterModsLoaded.push(j);},addEvent:function(f,h){e[f].push(h);},base64:l,buildReadSpeakerCall:function(f){return i(f);},data:a,Detect:{init:function(){rspkr.log("[rspkr.c.Detect] Initialized!");var f=navigator.userAgent;a.browser.name=this.searchString(this.dataBrowser)||"Unknown";a.browser.version=this.searchVersion(f)||this.searchVersion(navigator.appVersion)||"Unknown";a.browser.OS=this.searchString(this.dataOS)||"Unknown";a.browser.flashVersion=this.getFlashVersion();rspkr.log("[rspkr.c.Detect.init] Flash version: "+a.browser.flashVersion,1);a.browser.syncContainer="default"!==rspkr.pub.Config.item("general.syncContainer")?rspkr.pub.Config.item("general.syncContainer"):"rs:span";f=a.browser.name;this.browserSettings.hasOwnProperty(a.browser.name)||(this.browserSettings[f]={});"default"===rspkr.pub.Config.item("general.syncContainer")&&this.browserSettings[f].hasOwnProperty("syncContainer")&&(a.browser.syncContainer=this.browserSettings[f].syncContainer);this.browserSettings[f].hasOwnProperty("html5Support")?a.browser.html5Support=this.browserSettings[f].html5Support:document.createElement("audio").canPlayType&&(a.browser.html5Support=!0);if(!0===a.browser.html5Support){var h=document.createElement("audio"),k=!1,m=!1;h.canPlayType&&(k=!!h.canPlayType&&""!=h.canPlayType("audio/mpeg"),m=!!h.canPlayType&&""!=h.canPlayType('audio/ogg; codecs="vorbis"'));rspkr.log("Browser can play mp3? "+h.canPlayType("audio/mpeg"),1);rspkr.log("Browser can play ogg? "+h.canPlayType('audio/ogg; codecs="vorbis"'),1);/android/i.test(rspkr.Common.data.browser.OS)&&/chrome/i.test(rspkr.Common.data.browser.name)?a.browser.html5AudioFormat="ogg":!0===k?a.browser.html5AudioFormat="mp3":!0===m?a.browser.html5AudioFormat="ogg":a.browser.html5Support=!1;a.browser.html5Priority=this.browserSettings[f].hasOwnProperty("html5Priority")?this.browserSettings[f].priority:!0;this.browserSettings[f].hasOwnProperty("audioFormat")&&(a.browser.html5AudioFormat=this.browserSettings[f].audioFormat);}this.browserSettings[f].hasOwnProperty("minver")&&parseFloat(a.browser.version)<=parseFloat(this.browserSettings[f].minver)&&(a.browser.html5Priority=!1);},browserSettings:{Android:{minver:4},Explorer:{syncContainer:"font"},Firefox:{minver:6},Opera:{html5Support:!1,priority:!1},Edge:{audioFormat:"mp3"}},getFlashVersion:function(){try{if(document.selection){try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{f.AllowScriptAccess="always";}catch(h){return"6,0,0";}}catch(k){}return(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}}catch(m){}}catch(n){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1];}}catch(o){}}return"0,0,0";},searchString:function(f){for(var h=0;h<f.length;h++){var k=f[h].string,m=f[h].prop;this.versionSearchString=f[h].versionSearch||f[h].identity;if(k){if(-1!=k.indexOf(f[h].subString)){return f[h].identity;}}else{if(m){return f[h].identity;}}}},searchVersion:function(f){var h=f.indexOf(this.versionSearchString);if(-1!=h){return parseFloat(f.substring(h+this.versionSearchString.length+1));}},dataBrowser:[{string:navigator.userAgent,subString:"Edge",identity:"Edge"},{string:navigator.userAgent,subString:"Chromium",identity:"Chromium"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"ARM",identity:"Windows Phone"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},dispatchEvent:function(f,h,k){d(f,h,k);},post:b,cookie:{create:function(f,h,k,m,n){k=k||rspkr.pub.Config.item("general.cookieLifetime");m=m||rspkr.pub.Config.item("general.cookiePath");n=n||rspkr.pub.Config.item("general.cookieDomain");if(k){var o=new Date;o.setTime(o.getTime()+k);k="; expires="+o.toGMTString();}else{k="";}return document.cookie=f+"="+h+k+(m?"; path="+m:"")+(n?"; domain="+n:"");},read:function(f){f+="=";for(var h=document.cookie.split(";"),k=0;k<h.length;k++){for(var m=h[k];" "==m.charAt(0);){m=m.substring(1,m.length);}if(0==m.indexOf(f)){return m.substring(f.length,m.length);}}},readKey:function(f,h){var k=this.read(f),m;if(k){for(var k=k.split("&"),n=0,o=k.length;n<o;n++){if(m=k[n].split("="),m[0]==h){return m[1];}}}},readKeyAll:function(f){f=this.read(f);var h={},k;if(f){f=f.split("&");for(var m=0,n=f.length;m<n;m++){k=f[m].split("="),h[k[0]]=k[1];}return h;}},createSub:function(h,k,m,n,o){if("object"!==typeof k){this.create(h,k.toString(),m,n,o);}else{var q=[],p;for(p in k){q.push(p+"="+k[p]);}return this.create(h,q.join("&"),m,n,o);}},updateKey:function(o,p,q,r,t,v){q=q.toString();for(var u=decodeURIComponent(this.read(o)),w,A={},y=!1,u=u&&"null"!=u&&"undefined"!=u?-1<u.indexOf("=")&&-1==u.indexOf("&")?[u]:u.split("&"):[],x=0,z=u.length;x<z;x++){w=u[x].split("="),w[0]==p&&(w[1]=q,y=!0),w.length&&w[1].length&&(A[w[0]]=w[1]);}!y&&q.length&&(A[p]=q);return this.createSub(o,A,r,t,v);},erase:function(f,h,k){this.create(f,"",-1,h,k);}},css:{getStylesheet:function(f){var h;(h=document.styleSheets[f]||document.getElementById(f))||(h=document.createElement("style"),h.type="text/css",h.id=h.name=f,(document.getElementsByTagName("head")[0]||document.body).appendChild(h),h.addRule||h.sheet||(h=document.styleSheets[f]));return h.sheet||h;},rsSheet:function(f){try{this.rules=f.rules||f.cssRules;}catch(h){this.rules=f.cssRules;}this.del=function(k,m){k.deleteRule?k.deleteRule(m):k.removeRule&&k.removeRule(m);};this.ins=function(k,m,n){$rs.isArray(n)||(n=[n]);if(k.insertRule&&k.cssRules){k.insertRule(m+" {"+n.join(";")+";}",k.cssRules.length);}else{if(k.addRule){for(var p=0,o=n.length;p<o;p++){k.addRule(m,n[p]);}}}};},setRule:function(f,h,k){f=this.getStylesheet(f);var m=new this.rsSheet(f);m.ins(f,h,"string"==typeof k?k.split(";"):k);return m.length;},removeRule:function(h,k){var m=this.getStylesheet(h),n=new this.rsSheet(m),o=[];if(n.rules){for(var q=0,p=n.rules.length;q<p;q++){n.rules[q].selectorText==k&&o.push(q);}for(;o.length;){n.del(m,o.pop());}return o;}return n;},replaceRule:function(f,h,k){this.removeRule(f,h);this.setRule(f,h,k);}},converter:g,findFirstRSButton:function(){for(var f=$rs.get("a, .rsbtn_play"),f=$rs.isArray(f)?f:[f],h=0,k=f.length;h<k;h++){if($rs.hasClass(f[h],"rsbtn_play")||$rs.getAttr(f[h],"href")&&-1!==$rs.getAttr(f[h],"href").indexOf(rspkr.pub.Config.item("general.domain")+"/cgi-bin/"+rspkr.pub.Config.item("general.rsent"))||$rs.getAttr(f[h],"href")&&/customerid=/i.test($rs.getAttr(f[h],"href"))&&/lang=/i.test($rs.getAttr(f[h],"href"))&&/(readid|readclass)/i.test($rs.getAttr(f[h],"href"))){return f[h];}}return !1;},decodeEntities:function(f){var h=document.createElement("p");h.innerHTML=f;return h.textContent||h.innerText;},e:e,createShortcuts:function(){var f=window.ReadSpeaker;f.Common&&(f.c=f.Common);f.c&&(f.evt=f.c.addEvent,f.devt=f.c.dispatchEvent);f.c&&f.c.Settings&&(f.c.s=f.c.Settings);f.c.s&&(f.st=f.c.s);f.lib&&(f.l=f.lib);f.l&&f.lib.Facade&&(f.l.f=f.lib.Facade);f.l&&f.l.f&&f.l.f.adapter&&(f.l.f.a=f.l.f.adapter);f.modmap&&(f.m=f.modmap);f.pub&&f.pub.Config&&(f.pub.c=f.pub.Config);f.pub.c&&(f.cfg=f.pub.c);f.PlayerAPI&&(f.pl=f.PlayerAPI);f.HL&&(f.hl=f.HL);f.ui&&(f.u=f.ui);}};}();rspkr.lib||(rspkr.lib={});rspkr.lib.Facade=function(b){var c=function(n,q,o){n=String(n);o=String(o);q="="==q?"==":q;n=n.split(".");o=o.split(".");for(var p=Math.max(n.length,o.length),g,i,j=0,l=0;l<p&&!j;l++){g=parseInt(n[l],10)||0,i=parseInt(o[l],10)||0,g<i&&(j=1),g>i&&(j=-1);}switch(q){case"==":return 0==j;case"===":return 0===j;case"!=":return 0!=j;case"!==":return 0!==j;case"<":return 0<j;case"<=":return 0<=j;case">":return 0>j;case">=":return 0>=j;default:return !1;}},d=[{name:"jquery",minver:"1.4",check:function(){if("function"==typeof jQuery){if("explorer"===rspkr.Common.data.browser.name.toLowerCase()&&9>rspkr.Common.data.browser.version&&c(jQuery.fn.jquery,"<",2)){return !1;}if(c(jQuery.fn.jquery,">=",this.minver)){return !0;}}return !1;}}],a="",e={store:[],push:function(g,j,i){this.store[g]||(this.store[g]=[]);this.store[g][j]||(this.store[g][j]=[]);this.store[g][j].push(i);return this.store.length;},pop:function(i,n,j){var l;if(this.store[i]&&this.store[i][n]){l=this.store[i][n];if(!j){return this.store[i][n].splice(0,this.store[i][n].length),0;}for(var g=l.length-1;-1<g;g--){l[g].toString()==j.toString()&&this.store[i][n].splice(g,1);}return this.store[i][n].length;}return 0;},dispatch:function(l,o){var m=$rs.convertEvent(l,o);if(rsid=$rs.getAttr(m.target,"data-rsevent-id")){for(var p=!0,g=e.store[rsid][m.type],i=0,j=g.length;i<j;i++){"function"==typeof g[i]&&(g[i].apply(m.target,[m])||(p=!1));}return p;}}};return{init:function(){if(rspkr&&rspkr.params&&rspkr.params.forceRSLib&&"1"===rspkr.params.forceRSLib){a="RSLib";}else{for(idx in d){if(d[idx]&&d[idx].check&&d[idx].check()){a=d[idx].name;break;}}a.length||(a="RSLib");}},currentLib:function(){return a;},setLib:function(f){a=f;},eq:e,adapterInit:function(g){b.$rs=g;b.$rs.flatten=function(j,l){l=l||[];for(var m=0,i;i=j[m];m++){$rs.isArray(i)?$rs.flatten(i,l):l.push(i);}return l;};}};}(window);ReadSpeaker.lib.Facade.RSEvent=function(){};ReadSpeaker.modmap={products:{all:[["Common.Settings","text/javascript",["Common.Settings"]]],custom:function(){var a=[];a.push(["Custom","text/javascript"]);return a;},dr:function(){var a=[];a.push(["DocReader.AutoAdd","text/javascript"]);return a;},expl:function(){var a=this.all;a.push(["PlayerAPI","text/javascript"],["XP","text/javascript"],["ui","text/javascript",["ui","ui.Lightbox","ui.Slider"]]);return a;},embhl:function(){var a=this.all;a.push(["PlayerAPI","text/javascript"],["HL","text/javascript"],["ui","text/javascript",["ui","ui.Lightbox","ui.Slider"]]);return a;}}};